!function(){"use strict";angular.module("myproperties",["ngAnimate","ngFileUpload","ngCookies","ngSanitize","ngMessages","pascalprecht.translate","ngAria","ui.router","ngMaterial","toastr","firebase","ngMap"])}(),function(){"use strict";function e(e,t,r,n,o,a,i,l,d,p,s){var u=this;u.editGps=!1;var c=function(){a.params.property?u.property=a.params.property:u.property=u.blancProperty,i.loadList(["saleTypes","docTypes"])};u.openAddDialog=function(e){var r="";switch(e.object){case"saleType":r="Añadir nuevo tipo de venta";break;case"docType":r="Añadir nuevo tipo de documento"}var n=t.prompt().title(r).placeholder("Nombre").ariaLabel(r).ok("Aceptar").cancel("Cancelar");t.show(n).then(function(t){var r={name:t};u.addElement(r,e)})},u.addElement=function(e,t){r.loading=!0,e=i.prepareObject(e),r.root.child(t.reference).push(e).then(function(e){var n=e.key;u.property[t.object]=n,r.loading=!1,o.info("Se añadio elemento con exito")})},u.saveText="Guardar Propiedad",u.blancProperty={owners:[{}],intermediaries:[]},u.googleMapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyA-BPAOyFhVGBMCXS9fB5Yc6Dioh2360",u.deleteImage=function(e,t){t.splice(e,1)},u.addMarker=function(e){if(u.editGps){var t=e.latLng;u.property.gps={lat:t.lat(),lng:t.lng()}}},u.goBack=function(){r.go("admin.properties")},u.addRow=function(e){u.property[e].push({})},u.deleteRow=function(e,t){u.property[e].splice(t,1)},u.deletePropertyImage=function(e,t){var n=d.child("images/"+t+"/"+e.name);n["delete"]().then(function(){var n={};n["images/"+e.uid]=null,n["properties/"+t+"/images/"+e.uid]=null,r.root.update(n).then(function(){o.info("Se elimino la imagen")},function(e){l.log(e)})})["catch"](function(e){l.log(e)})};var m=function(e){var t=p.defer(),r={status:!1};return e.on("state_changed",function(){},function(e){r.error=e,t.resolve(r)},function(){r.status=!0,r.url=e.snapshot.downloadURL,t.resolve(r)}),t.promise},g=function(e){var t=p.defer(),o="";return e=i.prepareObject(e),o=angular.isDefined(e.$id)?r.root.child("properties/"+e.$id).update(n(e)):r.root.child("properties").push(n(e)),o.then(function(n){if(l.log(n,e),angular.isUndefined(e.$id)&&(u.property.$id=n.key),l.log(u.files,angular.isDefined(u.files)),angular.isDefined(u.files)){var o={},a={};angular.forEach(u.files,function(e,t){var n=r.root.child("images").push().key,i=n+"."+s(e.name);o[t]={id:n,index:t,originalName:e.name,newName:i},a[t]=m(d.child("images/"+u.property.$id+"/"+i).put(e))}),p.all(a).then(function(a){var i={};angular.forEach(a,function(t,r){if(t.status){var n=o[r].id;delete o[r].id,o[r].url=t.url,i["images/"+n]=o[r],i["properties/"+e.$id+"/images/"+n]={url:t.url,name:o[r].newName,uid:n}}u.files.splice(r,1)}),l.log(i),r.root.update(i).then(function(){t.resolve(n)},function(e){t.reject(e)})}),t.resolve(n)}else t.resolve(n)},function(e){t.reject(e)}),t.promise};u.saveProperty=function(e,t){l.log(t),r.loading=!0,u.saveText="Guardando...",g(e).then(function(e){o.info("Se guardo la propiedad"),r.loading=!1,u.goBack()},function(e){o.warning(e)})},u.verifyAddOption=function(e){"object"==typeof e&&"add"==e.action&&(delete u.property[e.object],u.openAddDialog(e))},c()}e.$inject=["$scope","$mdDialog","AppF","clearObjectFilter","toastr","$state","FirebaseF","$log","FbStorage","$q","fileExtensionFilter"],angular.module("myproperties").controller("PropertiesRecordController",e)}(),function(){"use strict";function e(e,t,r){var n=this;r.loadList(["saleTypes","docTypes","properties"]),n.go=function(e){if(angular.isDefined(e)&&"object"==typeof e){var r={property:e};t.go("admin.properties.details",r)}else t.go("admin.properties.details")}}e.$inject=["$firebaseArray","AppF","FirebaseF"],angular.module("myproperties").controller("PropertiesRecordsController",e)}(),function(){"use strict";function e(){function e(){return t}var t=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Angular Material Design",url:"https://material.angularjs.org/#/",description:"The Angular reference implementation of the Google's Material Design specification.",logo:"angular-material.png"},{title:"Less",url:"http://lesscss.org/",description:"Less extends the CSS language, adding features that allow variables, mixins, functions and many other techniques.",logo:"less.png"}];this.getTec=e}angular.module("myproperties").service("webDevTec",e)}(),function(){"use strict";function e(){function e(e){var t=this;t.relativeDate=e(t.creationDate).fromNow()}e.$inject=["moment"];var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("myproperties").directive("acmeNavbar",e)}(),function(){"use strict";function e(e){function t(t,r,n,o){var a,i=e(r[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "});r.addClass("acme-malarkey"),angular.forEach(t.extraValues,function(e){i.type(e).pause()["delete"]()}),a=t.$watch("vm.contributors",function(){angular.forEach(o.contributors,function(e){i.type(e.login).pause()["delete"]()})}),t.$on("$destroy",function(){a()})}function r(e,t){function r(){return n().then(function(){e.info("Activated Contributors View")})}function n(){return t.getContributors(10).then(function(e){return o.contributors=e,o.contributors})}var o=this;o.contributors=[],r()}r.$inject=["$log","githubContributor"];var n={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:t,controller:r,controllerAs:"vm"};return n}e.$inject=["malarkey"],angular.module("myproperties").directive("acmeMalarkey",e)}(),function(){"use strict";function e(e,t){function r(r){function o(e){return e.data}function a(t){e.error("XHR Failed for getContributors.\n"+angular.toJson(t.data,!0))}return r||(r=30),t.get(n+"/contributors?per_page="+r).then(o)["catch"](a)}var n="https://api.github.com/repos/Swiip/generator-gulp-angular",o={apiHost:n,getContributors:r};return o}e.$inject=["$log","$http"],angular.module("myproperties").factory("githubContributor",e)}(),function(){"use strict";function e(e,t,r,n,o,a,i,l,d){var p=this;p.AuthF=l,p.F=n,p.FBF=d,p.AuthF=l,p.loading=!1}e.$inject=["$timeout","webDevTec","toastr","AppF","firebase","$firebaseArray","clearObjectFilter","AuthF","FirebaseF"],angular.module("myproperties").controller("MainController",e)}(),function(){"use strict";function e(e,t,r,n,o){function a(){p.firebaseUser=null,p.error=null,s.$signInWithEmailAndPassword(p.formData.email,p.formData.password).then(function(e){p.firebaseUser=e,o.go("admin")})["catch"](function(e){p.error=e,n.log(e),d(e.message)})}function i(){e(function(){p.classAnimation="rubberBand"},4e3)}function l(){t.info('Fork <a href="https://github.com/Swiip/generator-gulp-angular" target="_blank"><b>generator-gulp-angular</b></a>'),p.classAnimation=""}function d(e){t.error(e),p.classAnimation=""}var p=this,s=r();p.classAnimation="",p.showToastr=l,p.signIn=a,i()}e.$inject=["$timeout","toastr","$firebaseAuth","$log","$state"],angular.module("myproperties").controller("LoginController",e)}(),function(){"use strict";function e(){function e(e){return e.split(".").pop()}return e}angular.module("myproperties").filter("fileExtension",e)}(),function(){"use strict";function e(){function e(e){e=angular.copy(e);var t={};return angular.forEach(e,function(e,r){switch(r){case"$priority":break;case"$id":break;case"$$conf":break;default:t[r]=e}}),t}return e}angular.module("myproperties").filter("clearObject",e)}(),function(){"use strict";function e(e,t,r,n,o){n.initializeApp(r);var a=n.auth();t.debug("runBlock end"),e.$on("$stateChangeError",function(e,t,r,n,a,i){"AUTH_REQUIRED"===i&&o.go("login")}),a.onAuthStateChanged(function(e){e||o.go("login")})}e.$inject=["$rootScope","$log","FB_CONFIG","firebase","$state"],angular.module("myproperties").run(e)}(),function(){"use strict";function e(e,t,r,n,o){o.useLoader("$translatePartialLoader",{urlTemplate:"{part}/i18n/{lang}.json"}),o.preferredLanguage("es"),n.addPart("app"),r.html5Mode(!0),e.state("admin",{url:"/admin",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main",resolve:{currentAuthF:["AuthF",function(e){return e.$requireSignIn()}]}}).state("admin.properties",{url:"/properties",views:{"content@admin":{templateUrl:function(){return"app/main/views/propertiesRecords/propertiesRecords.html"},controller:"PropertiesRecordsController",controllerAs:"propertiesCtrl"}},resolve:{currentAuthF:["AuthF",function(e){return e.$requireSignIn()}]}}).state("admin.properties.details",{url:"/details",params:{property:!1},views:{"content@admin":{templateUrl:function(){return"app/main/views/propertiesRecord/propertiesRecord.html"},controller:"PropertiesRecordController",controllerAs:"propertyCtrl"}},resolve:{currentAuthF:["AuthF",function(e){return e.$requireSignIn()}]}}).state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginController",controllerAs:"main"}),t.otherwise("/admin/properties")}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$translatePartialLoaderProvider","$translateProvider"],angular.module("myproperties").config(e)}(),function(){"use strict";function e(e){return e()}function t(e){return e.storage().ref()}function r(e,t){function r(t,r){angular.isDefined(r)&&"object"==typeof r?e.go(t,r):e.go(t)}var n={go:r,root:t.database().ref("/")};return n}function n(e,t,r){function n(e){return angular.isUndefined(e.saved)?e.saved={date:r.database.ServerValue.TIMESTAMP,user:r.auth().currentUser.uid}:e.updated={date:r.database.ServerValue.TIMESTAMP,user:r.auth().currentUser.uid},e}function o(r){angular.isUndefined(i[r])&&(i[r]=e(t.root.child(r)))}function a(e){switch(typeof e){case"object":angular.forEach(e,function(e){o(e)});break;case"string":o(e)}}var i={loadList:a,prepareObject:n};return i}e.$inject=["$firebaseAuth"],r.$inject=["$state","firebase"],n.$inject=["$firebaseArray","AppF","firebase"],t.$inject=["firebase"],angular.module("myproperties").factory("AuthF",e).factory("AppF",r).factory("FirebaseF",n).factory("FbStorage",t)}(),function(){"use strict";angular.module("myproperties").constant("malarkey",malarkey).constant("moment",moment).constant("FB_CONFIG",{apiKey:"AIzaSyCghgZ-p-Ek11XWf_OCRptlUcTqyA7KI0c",authDomain:"myproperties-c4a80.firebaseapp.com",databaseURL:"https://myproperties-c4a80.firebaseio.com",storageBucket:"myproperties-c4a80.appspot.com",messagingSenderId:"234749633393"})}(),function(){"use strict";function e(e,t){e.debugEnabled(!0),t.allowHtml=!0,t.timeOut=3e3,t.positionClass="toast-top-right",t.preventDuplicates=!0,t.progressBar=!0}e.$inject=["$logProvider","toastrConfig"],angular.module("myproperties").config(e)}(),angular.module("myproperties").run(["$templateCache",function(e){e.put("app/login/login.html","<md-content layout=row layout-align=space-around layout-padding=layout-padding ng-cloak=ng-cloak class=login-form><md-card flex=flex flex-gt-sm=50 flex-gt-md=33><md-toolbar><div class=md-toolbar-tools><h2><span>{{'loginPage.formName' | translate}}</span></h2></div></md-toolbar><md-card-content><form name=Form ng-submit=main.signIn()><md-input-container class=md-block><label>{{'loginPage.labelUsername' | translate}}</label><input type=text name=email ng-model=main.formData.email placeholder=\"{{'loginPage.inputUsername' | translate}}\" required><div ng-messages=Form.email.$error role=alert multiple><div ng-message=required class=my-message>{{'loginPage.invalidUsername' | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{'loginPage.labelPassword' | translate}}</label><input type=password name=password ng-model=main.formData.password placeholder=\"{{'loginPage.inputPassword' | translate}}\" required md-maxlength=16><div ng-messages=Form.password.$error role=alert multiple><div ng-message=required class=my-message>{{'loginPage.invalidPassword' | translate}}</div></div></md-input-container><md-button ng-disabled=!Form.$valid type=submit ng-click=main.signIn() class=\"md-raised md-primary\">&nbsp {{'loginPage.buttonLogin' | translate}} &nbsp</md-button></form></md-card-content></md-card></md-content>"),e.put("app/main/main.html",'<div layout=column ng-cloak=ng-cloak layout-fill><md-toolbar class=md-hue-2><div class=md-toolbar-tools><!--<md-button ng-click="toggleRight()" ng-hide="isOpenRight()">\n        <md-icon> view_headline </md-icon>\n      </md-button>--><h2 flex=nogrow><span>Panel de Administracion</span></h2><span flex></span><div flex=nogrow><md-button ng-click=main.AuthF.$signOut()><md-icon>exit_to_app</md-icon></md-button></div></div></md-toolbar><div ui-view=content></div></div>'),e.put("app/components/navbar/navbar.html",'<md-toolbar layout=row layout-align="center center"><md-button href=https://github.com/Swiip/generator-gulp-angular>Gulp Angular</md-button><section flex layout=row layout-align="left center"><md-button href=# class=md-raised>Home</md-button><md-button href=# class=md-raised>About</md-button><md-button href=# class=md-raised>Contact</md-button></section><md-button class=acme-navbar-text>Application was created {{ vm.relativeDate }}.</md-button></md-toolbar>'),e.put("app/main/views/propertiesRecord/propertiesRecord.html",'<md-content layout-padding=layout-padding><div flex layout=row layout-align="start center"><div flex=nogrow><md-button class=md-icon-button aria-label="Go Back" ng-click=propertyCtrl.goBack()><md-icon>keyboard_backspace</md-icon></md-button></div><h1 flex=nogrow>Detalles de Propiedad</h1></div><div flex layout=row layout-align="start center"><h2>Informacion Publica</h2></div><form name=propertyForm><div layout=column layout-gt-xs=row><md-input-container flex><label>Ubicacion</label><input type=text required ng-model=propertyCtrl.property.location></md-input-container></div><div layout=column layout-gt-xs=row><md-input-container flex=30><label>M2</label><input required type=number ng-model=propertyCtrl.property.meters></md-input-container><md-input-container flex=70><label>Referencia mas cercana</label><input type=text ng-model=propertyCtrl.property.closerReference></md-input-container></div><div layout=column layout-gt-xs=row><md-input-container flex><label>Campo Libre</label><input type=text ng-model=propertyCtrl.property.otherpublic></md-input-container></div><div layout=column layout-align="start start"><div flex layout=row layout-align="start center"><h3 flex=nogrow>Imagenes</h3><div flex=nogrow><md-button class="md-raised md-primary" ngf-select ng-model=propertyCtrl.files name=files ngf-multiple=true ngf-pattern="\'image/*\'" ngf-accept="\'image/*\'" ngf-max-size=20MB ngf-min-height=100>Agregar Imagenes</md-button></div></div></div><div flex><md-grid-list md-cols-xs=1 md-cols-sm=2 md-cols-md=3 md-cols-lg=4 md-cols-gt-lg=5 md-row-height=4:3 md-gutter=1em><md-grid-tile md-colspan=1 ng-repeat="($index,file) in propertyCtrl.files"><img class=layout-fill ng-show=propertyForm.files.$valid ngf-thumbnail=file><md-grid-tile-footer layout=row layout-align="end center"><div flex><div layout=row layout-align="end center"><div flex=nogrow><md-button ng-click=propertyCtrl.deleteImage($index,propertyCtrl.files) class="md-fab md-mini md-warn md-raised md-hue-2"><md-icon>delete_forever</md-icon></md-button></div></div></div></md-grid-tile-footer></md-grid-tile><md-grid-tile md-colspan=1 ng-repeat="($index,image) in propertyCtrl.property.images"><img class=layout-fill ng-src={{image.url}} alt=Imagen><md-grid-tile-footer layout=row layout-align="end center"><div flex=nogrow><md-button ng-click=propertyCtrl.deletePropertyImage(image,propertyCtrl.property.$id) class="md-fab md-mini md-warn md-raised md-hue-2"><md-icon>delete_forever</md-icon></md-button></div></md-grid-tile-footer></md-grid-tile></md-grid-list></div><div layout=column layout-align="start start"><div flex layout=row layout-align="start center"><h3 flex=nogrow>Mapa</h3><div flex=nogrow><md-button class="md-raised md-primary" ng-click="propertyCtrl.editGps=!propertyCtrl.editGps">{{propertyCtrl.editGps?\'Guardar\':\'Editar Ubicacion\'}}</md-button></div></div></div><div layout=column layout-gt-xs=row><div flex><div map-lazy-load=https://maps.google.com/maps/api/js map-lazy-load-params={{propertyCtrl.googleMapsUrl}} height=600px><ng-map center=current-location zoom=9 on-click=propertyCtrl.addMarker()><marker position={{propertyCtrl.property.gps.lat}},{{propertyCtrl.property.gps.lng}}></marker></ng-map></div></div></div><div flex layout=row layout-align="start center"><h2>Informacion Privada</h2></div><div layout=column layout-gt-xs=row><md-input-container flex><label>Tipo de documento</label><md-select required ng-model=propertyCtrl.property.docType ng-change=propertyCtrl.verifyAddOption(propertyCtrl.property.docType,this)><md-option ng-repeat="docType in main.FBF.docTypes" ng-value=docType.$id>{{docType.name}}</md-option><md-option ng-value="{action:\'add\',object:\'docType\',reference:\'docTypes\'}">Agregar nuevo</md-option></md-select></md-input-container><md-input-container flex><label>Precio Pactado</label><input required type=number ng-model=propertyCtrl.property.price></md-input-container><md-input-container flex><label>Precio Venta</label><input required type=number ng-model=propertyCtrl.property.salePrice></md-input-container></div><div layout=row layout-align="start center"><div flex=nogrow><h3>Propietario</h3></div><div flex=nogrow><md-button class="md-raised md-primary" ng-click="propertyCtrl.addRow(\'owners\')">Agregar Propietario</md-button></div></div><div layout=column><div flex layout=column layout-gt-xs=row layout ng-repeat="($index,owner) in propertyCtrl.property.owners"><md-input-container flex><label>Nombre</label><input required type=name ng-model=owner.name></md-input-container><md-input-container flex><label>Telefono</label><input required type=text ng-model=owner.phone></md-input-container><md-input-container flex><label>Correo</label><input type=email ng-model=owner.email></md-input-container><div flex=nogrow><md-button class="md-raised md-primary" ng-click="propertyCtrl.deleteRow(\'owners\',$index)">Eliminar</md-button></div></div></div><div layout layout-align="start center"><div flex=nogrow><h3>Intermediarios</h3></div><div flex=nogrow><md-button class="md-raised md-primary" ng-click="propertyCtrl.addRow(\'intermediaries\')">Agregar Intermediario</md-button></div></div><div layout=column><div flex layout=column layout-gt-xs=row ng-repeat="($index,intermediary) in propertyCtrl.property.intermediaries"><md-input-container flex><label>Nombre</label><input required type=name ng-model=intermediary.name></md-input-container><md-input-container flex><label>Telefono</label><input required type=text ng-model=intermediary.phone></md-input-container><div flex=nogrow><md-button class="md-raised md-primary" ng-click="propertyCtrl.deleteRow(\'intermediaries\',$index)">Eliminar</md-button></div></div></div><div layout=column layout-gt-xs=row><md-input-container flex=30><label>Tipo de venta</label><md-select required ng-model=propertyCtrl.property.saleType ng-change=propertyCtrl.verifyAddOption(propertyCtrl.property.saleType,this)><md-option ng-repeat="saleType in main.FBF.saleTypes" ng-value=saleType.$id>{{saleType.name}}</md-option><md-option ng-value="{action:\'add\',object:\'saleType\',reference:\'saleTypes\'}">Agregar nuevo</md-option></md-select></md-input-container><md-input-container flex=70><label>Campo Libre</label><input type=text ng-model=propertyCtrl.property.otherprivate></md-input-container></div><!--<div layout layout-sm="column" ng-if="propertyCtrl.addingSaleType">\n      <md-input-container flex>\n        <label>Nuevo Tipo de venta</label>\n        <input type="name" ng-model="propertyCtrl.newSaleType.name">\n        <md-button class="md-raised md-primary" ng-click="propertyCtrl.addElement(\'saleType\')" ng-disabled="main.F.loading">Agregar nuevo tipo de venta</md-button>\n        <md-button class="md-raised md-primary" ng-click="propertyCtrl.addingSaleType=false" ng-disabled="main.F.loading">Cancelar</md-button>\n      </md-input-container>\n    </div>--><div layout=row layout-sm=column><label flex></label><div flex=nogrow><md-button ng-disabled="!propertyForm.$valid || main.F.loading" ng-click=propertyCtrl.saveProperty(propertyCtrl.property,propertyCtrl.files) class="md-raised md-primary">{{propertyCtrl.saveText}}</md-button></div><div flex=nogrow><md-button ng-click=propertyCtrl.goBack() class="md-raised md-primary">Cancelar</md-button></div></div></form></md-content>'),e.put("app/main/views/propertiesRecords/propertiesRecords.html",'<md-content layout=column layout-padding=layout-padding><div flex layout=row layout-align="start center"><h1 flex=nogrow>Lista de propiedades</h1><div flex=nogrow><md-button class="md-raised md-primary" ng-click=propertiesCtrl.go()>Añadir Propiedad</md-button></div></div><md-list flex><md-list-item class=md-3-line ng-repeat="property in main.FBF.properties" ng-click=null><div class=md-list-item-text layout=row layout-align="start center"><div flex layout=column><h3 style=margin:0px>{{ property.location}} <small>{{ property.meters|currency }}</small></h3><p>{{ property.closerReference}}</p></div><div flex=nogrow><md-button class="md-raised md-primary" ng-click=propertiesCtrl.go(property)>Editar</md-button></div></div></md-list-item></md-list></md-content>')}]);
//# sourceMappingURL=../maps/scripts/app-a90de64487.js.map
